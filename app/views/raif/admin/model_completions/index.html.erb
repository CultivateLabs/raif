<h1 class="my-4"><%= t("raif.admin.common.model_completions") %></h1>

<div class="row">
  <div class="col-12">
    <%= form_tag raif.admin_model_completions_path, method: :get, class: "mb-4" do %>
      <div class="row align-items-end">
        <div class="col-md-4">
          <div class="form-group">
            <label for="status"><%= t("raif.admin.common.status") %></label>
            <%= select_tag :status,
                  options_for_select(
                    [
                      [t("raif.admin.common.all"), :all],
                      [t("raif.admin.common.completed"), :completed],
                      [t("raif.admin.common.failed"), :failed],
                      [t("raif.admin.common.in_progress"), :started],
                      [t("raif.admin.common.pending"), :pending]
                    ],
                    @selected_status
                  ),
                  { class: "form-select" } %>
          </div>
        </div>
        <div class="col-md-2">
          <%= submit_tag t("raif.admin.common.filter"), class: "btn btn-primary" %>
        </div>
      </div>
    <% end %>

    <% if @model_completions.any? %>
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead class="table-light">
            <tr>
              <th><%= t("raif.admin.common.id") %></th>
              <th><%= t("raif.admin.common.created_at") %></th>
              <th><%= t("raif.admin.common.source") %></th>
              <th><%= t("raif.admin.common.model") %></th>
              <th><%= t("raif.admin.common.response_format") %></th>
              <th><%= t("raif.admin.common.status") %></th>
              <th><%= t("raif.admin.common.total_tokens") %></th>
              <th><%= t("raif.admin.common.total_cost") %></th>
              <th><%= t("raif.admin.common.citations") %></th>
              <th><%= t("raif.admin.common.response") %></th>
            </tr>
          </thead>
          <tbody>
            <%= render partial: "raif/admin/model_completions/model_completion", collection: @model_completions %>
          </tbody>
        </table>
      </div>

      <div class="mt-4">
        <%== pagy_bootstrap_nav(@pagy) %>
      </div>
    <% else %>
      <div class="alert alert-info">
        <%= t("raif.admin.common.no_model_completions") %>
      </div>
    <% end %>
  </div>
</div>
